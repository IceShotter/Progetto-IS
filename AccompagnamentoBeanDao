public class AccompagnamentoBeanDao {
	


	public synchronized boolean doSave(AccompagnamentoBean ab) {
		boolean ritorno=false;
		Connection conn = null;
		 PreparedStatement ps = null;
		 try {
			conn = DriverManagerConnectionPool.getConnection();
			ps = conn.prepareStatement("INSERT INTO smartdash.accompagnamento (idaccompagnamento,descrizioneA,ora,data,studente,tutor,)VALUES( ?,?,?,?,?,?)");
			
			ps.setInt(1, ab.getId());
			ps.setString(2, ab.getDescrizione());
			ps.setString(3, ab.getOra());
			ps.setString(4, ab.getData());
			ps.setString(5, ab.getStudente());
			ps.setString(6, ab.getTutor());
			
			
			if(ps.executeUpdate()==0) {ritorno=false;}
			else {ritorno=true;}	
			conn.commit();
		 }catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}finally{
				try {
					ps.close();
					DriverManagerConnectionPool.releaseConnection(conn);
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}finally{
					try {
						ps.close();
						DriverManagerConnectionPool.releaseConnection(conn);
					} catch (SQLException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
				}
			}
		return ritorno;
	}
	
	
	public synchronized ArrayList<AccompagnamentoBean> doRetrieve(){
		ArrayList<AccompagnamentoBean> a=new ArrayList<AccompagnamentoBean>();
		Connection conn=null;
		PreparedStatement ps=null;
		try {
			conn=DriverManagerConnectionPool.getConnection();
			ps=conn.prepareStatement("select * FROM smartdash.accompagnamento");
			ResultSet res=ps.executeQuery();
			while(res.next()) {
				AccompagnamentoBean ab=new AccompagnamentoBean();
				ps.setInt(1,ab.getId());
				ps.setString(2,ab.getDescrizione());
				ps.setString(3, ab.getOra());
				ps.setString(4, ab.getData());
				ps.setString(5, ab.getStudente());
				ps.setString(6, ab.getTutor());
				}
		}
			catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}finally{
				try {
					ps.close();
					DriverManagerConnectionPool.releaseConnection(conn);
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			}
		return a;
	}
	
	
	
	public synchronized boolean doDelete(int id) {
			boolean ritorno= false;
			Connection conn=null;
			PreparedStatement ps= null;
			try {
					conn= DriverManagerConnectionPool.getConnection();
					ps= conn.prepareStatement("DELETE FROM smartdash.accompagnamento WHERE(idaccompagnamento=?)");
					ps.setInt(1, id);
					if(ps.executeUpdate()==1)ritorno=true;	
					conn.commit();
				} catch (SQLException e) { e.printStackTrace();}
			finally {
					try {
							ps.close();
							DriverManagerConnectionPool.releaseConnection(conn);				
						} catch (SQLException e) { e.printStackTrace();}
					}
			return ritorno;	
		}
	
}
	
public class AccompagnamentoBean {
	private int id;
	private String descrizione;
	private String ora;
	private String data;
	private String studente;
	private String tutor;
	
	public void Accompagnamento() {
		//empty constructor
	}
	
	
	
	public void Accompagnamento(int id, String descrizione, String ora, String data, String studente, String tutor) {
		this.id=id;
		this.descrizione=descrizione;
		this.ora=ora;
		this.data=data;
		this.studente=studente;
		this.tutor=tutor;
		
	}
	
	




	public int getId() {
		return id;
	}

	public String getDescrizione() {
		return descrizione;
	}

	
	
	

	public String getStudente() {
		return studente;
	}

	public String getTutor() {
		return tutor;
	}

	public void setId(int id) {
		this.id = id;
	}

	public void setDescrizione(String descrizione) {
		this.descrizione = descrizione;
	}

	

	public String getOra() {
		return ora;
	}



	public void setOra(String ora) {
		this.ora = ora;
	}



	public String getData() {
		return data;
	}



	public void setData(String data) {
		this.data = data;
	}



	public void setStudente(String studente) {
		this.studente = studente;
	}

	public void setTutor(String tutor) {
		this.tutor = tutor;
	}
	
	
}

